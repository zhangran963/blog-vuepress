---
title: '版本'
---

## [HTTP基础](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP)

## HTTP

* 超文本传输协议（英文：**HyperText Transfer Protocol**，缩写：HTTP）
* 特点: 
  + 无连接: 无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接，采用这种方式可以节省传输时间。(当今多数服务器支持Keep-Alive功能，使用服务器支持长连接，解决无连接的问题)
  + 无状态: 无状态是指协议对于事务处理没有记忆能力，服务器不知道客户端是什么状态。即客户端发送HTTP请求后，服务器根据请求，会给我们发送数据，发送完后，不会记录信息。(使用 cookie 机制可以保持 session，解决无状态的问题)
  + 简单快速: 当客户端向服务器端发送请求时，只是简单的填写请求路径和请求方法即可，然后就可以通过浏览器或其他方式将该请求发送就行了
  + 灵活: HTTP 协议允许客户端和服务器端传输任意类型任意格式的数据对象

***

## HTTP1.0

### 短连接

> 指通信双方有数据交互时，就建立一个TCP连接，数据发送完成后，则断开此TCP连接。

* 连接→数据传输→关闭连接

## 长连接

## [3次握手4次挥手](./3次握手4次挥手)

***

## HTTP1.1

* 连接可以复用，节省了多次打开TCP连接加载网页文档资源的时间。
* 增加管线化技术，允许在第一个应答被完全发送之前就发送第二个请求，以降低通信延迟。
* 支持响应分块。
* 引入额外的缓存控制机制。
* 引入内容协商机制，包括语言，编码，类型等，并允许客户端和服务器之间约定以最合适的内容进行交换。
* 感谢Host头，能够使不同域名配置在同一个IP地址的服务器上。
![](https://ran-1303246897.cos.ap-guangzhou.myqcloud.com/www/markdown/20210612160836.png)

### 长连接

> 指在一个TCP连接上可以连续发送多个数据包(请求)，在TCP连接保持期间，如果没有数据包(请求)发送，需要双方发检测包以维持此连接，一般需要自己做在线维持（不发生RST包和四次挥手）

* 保持连接去完成多次连续的请求; 
* 连接→数据传输→保持连接(心跳)→数据传输→保持连接(心跳)→……→关闭连接（一个TCP连接通道多个读写通信）

### 管线化

* 多个连续的请求不用等待立即返回就可以被发送; 
* 队首阻塞问题(前面的请求阻塞, 后面的无法响应)

***

## [HTTP/2](https://zh.wikipedia.org/wiki/HTTP/2)

* 二进制协议而不是文本协议, 不再可读; 
* 对数据传输采用多路复用，让多个请求合并在同一TCP连接内; 
* 对HTTP头字段进行数据压缩(即HPACK算法); 因为headers在一系列请求中常常是相似的，其移除了重复和传输重复数据的成本。
* HTTP/2 服务端推送(Server Push); 
* 请求流水线；

### 帧, 消息, 流 和 TCP连接

* 流: 将一个TCP连接分为若干个流（Stream）
* 消息: 每个流中可以传输若干消息（Message）
* 帧: 每个消息由若干最小的二进制帧（Frame）组成

* HTTP/2中，每个用户的操作行为被分配了一个流编号(stream ID)，这意味着用户与服务端之间创建了一个TCP通道；
* 协议将每个请求分割为二进制的控制帧与数据帧部分，以便解析。

### 解决"队首阻塞"问题

* HTTP1.1中, 包含一条一条的请求, 条与条之间有明确的顺序
* HTTP/2中, 每条请求都打散成帧, 帧是乱序发送的

### 服务端推送

> 网站为了使请求数减少，通常采用对页面上的图片、脚本进行极简化处理(压缩, 雪碧图)。但是，这一举措十分不方便，也不高效，依然需要诸多HTTP链接来加载页面和页面资源。

* 服务端向客户端发送比客户端请求更多的数据。
* 允许服务器直接提供浏览器渲染页面所需资源，而无须浏览器在收到、解析页面后再提起一轮请求，节约了加载时间。

***

## HTTP/3

* 改用(基于UDP协议的)**QUIC协议**实现

> 由于HTTP/2在单个TCP连接上使用了多路复用，受到TCP拥塞控制的影响，少量的丢包就可能导致整个TCP连接上的所有流被阻塞
